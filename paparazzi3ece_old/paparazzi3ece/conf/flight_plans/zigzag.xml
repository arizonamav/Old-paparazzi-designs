

<procedure>
  <param name="rad" default_value="30"/>
  <param name="alt"/>

  <waypoints>
    <waypoint name="LANDING" x="0" y="40"/>
    <waypoint name="TARGET" x="-120" y="100"/>
    <waypoint name="WP1" x="-140" y="20"/>
    <waypoint name="WP2" x="-60" y="80"/>
    <waypoint name="WP3" x="-60" y="100"/>
  </waypoints>

  <blocks>
    <block NAME="takeoff">
      <exception COND="(RcEvent1())" DEROUTE="back"/>
      <exception COND="(RcEvent2())" DEROUTE="target"/>
      <heading vmode="throttle" throttle="0.7" pitch="0.15" course="280" until="(estimator_flight_time > 5)"/>
      <go wp="WP1" alt="alt" approaching_time="1"/>
      <go wp="WP2" alt="alt" approaching_time="1"/>
      <go wp="WP3" alt="alt" approaching_time="1"/>
      <deroute block="target"/>
    </block>

    <block NAME="target">
      <exception COND="(RcEvent1())" DEROUTE="back"/>
      <exception COND="(RcEvent2())" DEROUTE="carrot"/>
      <circle WP="TARGET" RADIUS="rad" alt="alt"/>
    </block>

    <block NAME="carrot">
      <exception COND="(RcEvent1())" DEROUTE="back"/>
      <exception COND="(RcEvent2())" DEROUTE="target"/>
      <xyz radius="rad"/>
    </block>

    <block NAME="back">
      <exception COND="(RcEvent1())" DEROUTE="end"/>
      <exception COND="(RcEvent2())" DEROUTE="target"/>
      <circle wp="LANDING" alt="alt" radius="25"/>
    </block>
  </blocks>
</procedure>
